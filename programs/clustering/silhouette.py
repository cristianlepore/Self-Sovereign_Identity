import numpy as np
from sklearn.metrics import davies_bouldin_score, silhouette_score
from sklearn.manifold import MDS

# La tua matrice di distanze

D = np.array([
    [0.        , 1.41421356, 2.44948974, 6.63324958, 8.30662386, 7.34846923, 6.63324958, 7.93725393, 9.79795897, 9.74679434, 8.60232527, 8.94427191, 6.63324958, 5.91607978, 6.63324958],
    [1.41421356, 0.        , 2.64575131, 7.93725393, 9.74679434, 8.77496439, 8.06225775, 9.48683298,11.22497216,11.18033989, 9.94987437,10.24695077, 8.06225775, 7.07106781, 7.93725393],
    [2.44948974, 2.64575131, 0.        , 8.18535277, 9.21954446, 8.60232527, 7.61577311, 8.36660027,10.19803903,10.09950494, 8.42614977, 8.77496439, 7.21110255, 6.32455532, 7.61577311],
    [6.63324958, 7.93725393, 8.18535277, 0.        , 7.61577311, 5.09901951, 3.31662479, 2.82842712, 5.47722558, 4.58257569, 5.38516481, 5.91607978, 4.24264069, 6.32455532, 5.47722558],
    [8.30662386, 9.74679434, 9.21954446, 7.61577311, 0.        , 2.82842712, 4.12310563, 6.40312424, 3.74165739, 4.24264069, 6.08276253, 6.40312424, 5.83095189, 9.48683298, 7.21110255],
    [7.34846923, 8.77496439, 8.60232527, 5.09901951, 2.82842712, 0.        , 1.41421356, 4.12310563, 3.31662479, 3.16227766, 5.09901951, 5.47722558, 4.24264069, 8.06225775, 6.08276253],
    [6.63324958, 8.06225775, 7.61577311, 3.31662479, 4.12310563, 1.41421356, 0.        , 3.74165739, 4.12310563, 3.46410162, 4.12310563, 4.58257569, 3.60555128, 7.21110255, 5.        ],
    [7.93725393, 9.48683298, 8.36660027, 2.82842712, 6.40312424, 4.12310563, 3.74165739, 0.        , 4.24264069, 3.74165739, 4.58257569, 4.24264069, 3.60555128, 8.06225775, 6.32455532],
    [9.79795897,11.22497216,10.19803903, 5.47722558, 3.74165739, 3.31662479, 4.12310563, 4.24264069, 0.        , 2.23606798, 5.        , 5.38516481, 5.09901951,10.        , 7.21110255],
    [9.74679434,11.18033989,10.09950494, 4.58257569, 4.24264069, 3.16227766, 3.46410162, 3.74165739, 2.23606798, 0.        , 4.12310563, 4.24264069, 4.24264069, 9.05538514, 7.21110255],
    [8.60232527, 9.94987437, 8.42614977, 5.38516481, 6.08276253, 5.09901951, 4.12310563, 4.58257569, 5.        , 4.12310563, 0.        , 1.41421356, 1.41421356, 7.07106781, 5.83095189],
    [8.94427191,10.24695077, 8.77496439, 5.91607978, 6.40312424, 5.47722558, 4.58257569, 4.24264069, 5.38516481, 4.24264069, 1.41421356, 0.        , 1.41421356, 7.21110255, 6.08276253],
    [6.63324958, 8.06225775, 7.21110255, 4.24264069, 5.83095189, 4.24264069, 3.60555128, 3.60555128, 5.09901951, 4.24264069, 1.41421356, 1.41421356, 0.        , 6.08276253, 5.09901951],
    [5.91607978, 7.07106781, 6.32455532, 6.32455532, 9.48683298, 8.06225775, 7.21110255, 8.06225775,10.        , 9.05538514, 7.07106781, 7.21110255, 6.08276253, 0.        , 6.32455532],
    [6.63324958, 7.93725393, 7.61577311, 5.47722558, 7.21110255, 6.08276253, 5.        , 6.32455532, 7.21110255, 7.21110255, 5.83095189, 6.08276253, 5.09901951, 6.32455532, 0.        ]
])

clusters = {
    "Greedy 25th": [1, 1, 1, 1, 2, 2, 3, 3, 4, 4, 4, 4, 4, 4, 5],
    "Greedy 50th": [14, 14, 14, 14, 14, 15, 15, 15, 15, 15, 15, 16, 16, 17, 17],
    "Greedy 75th": [18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 20],
    "KMNS": [6, 6, 7, 9, 8, 10, 10, 9, 6, 8, 8, 10, 10, 9, 10],
    "Louvain": [11, 11, 11, 11, 13, 12, 12, 13, 11, 13, 13, 12, 12, 11, 12],
    "Greedy + Entropy": [21, 21, 24, 21, 23, 22, 22, 23, 21, 23, 23, 22, 22, 24, 22],
}

# Ricostruisco coordinate da D con MDS (dimensione 2 o pi√π)
mds = MDS(n_components=5, dissimilarity='precomputed', random_state=42)
X_embedded = mds.fit_transform(D)

for metodo, labels in clusters.items():
    # silhouette score con matrice precomputata
    sil_score = silhouette_score(D, labels, metric='precomputed')

    # Davies-Bouldin score su embedding MDS
    db_score = davies_bouldin_score(X_embedded, labels)

    print(f"{metodo:<20} Silhouette = {sil_score:.3f}, Davies-Bouldin = {db_score:.3f}")
